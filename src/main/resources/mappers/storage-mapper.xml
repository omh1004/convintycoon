<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="storage">
    <select id="selectAllPrd" parameterType="int" resultType="store">
        select  GOODSNO
             ,GOODSTYPE
             ,GOODSNAME
             ,EXPDATE
             ,image
             ,sum(ORDERQUANTITY) as ORDERQUANTITY
        from
            (select s.GOODSNO,
                    decode(s.EXPDATE, 0, 0, 1) as EXPDATE,
                    g.GOODSTYPE,
                    g.GOODSNAME,
                    s.ORDERQUANTITY,
                    decode(s.EXPDATE, 0,g.DEIMAGE,g.IMAGE ) image
             from GOODS g,
                  STORAGE s
             where 1 = 1
               and g.GOODSNO(+) = s.GOODSNO
               and s.playno=#{gameNo}
            )
        group by  GOODSNO,GOODSTYPE,GOODSNAME,EXPDATE,image
    </select>



    </mapper>
